# -*- coding: utf-8 -*-
"""generating_dataset.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1RJU5MEdAZT3htu4_VLjxvYoYasSJEQOs
"""

!pip install --upgrade diffusers transformers accelerate torch

import torch
from diffusers import StableDiffusionPipeline
import os
from matplotlib import pyplot as plt

# 1. Setup the storage folder (Dataset Creation)
output_folder = "synthetic_dataset"
os.makedirs(output_folder, exist_ok=True)

# 2. Load the Pre-trained Model
# We are using Stable Diffusion v1.5, a standard industry model
model_id = "runwayml/stable-diffusion-v1-5"
pipe = StableDiffusionPipeline.from_pretrained(model_id, torch_dtype=torch.float16)

# Move the model to the GPU for faster generation
pipe = pipe.to("cuda")

prompts = [
    "A futuristic city with flying cars and neon lights, cyberpunk style",
    "A cute astronaut cat exploring mars, high definition",
    "A serene japanese garden with cherry blossoms in spring, watercolor style",
    "A robot playing chess against a human in a park, photorealistic",
    "A medieval castle on a floating island in the sky, fantasy art"
]

print(f"Starting generation for {len(prompts)} images...")

# 4. Generate Synthetic Data
generated_images = []

for i, prompt in enumerate(prompts):
    print(f"Generating: {prompt}")

    # Generate the image
    image = pipe(prompt).images[0]
    generated_images.append(image)

    # 5. Save generated output
    file_path = f"{output_folder}/sample_{i+1}.png"
    image.save(file_path)
    print(f"Saved to {file_path}")

print("\nData Generation Complete!")

# 6. Display Sample Outputs
# Create a figure to display images in a row
plt.figure(figsize=(20, 5))
for i, image in enumerate(generated_images):
    plt.subplot(1, 5, i+1)
    plt.imshow(image)
    plt.axis('off')
    plt.title(f"Sample {i+1}")
plt.show()

import torch
from diffusers import StableDiffusionPipeline
import os

# 1. Setup the Model
model_id = "runwayml/stable-diffusion-v1-5"
pipe = StableDiffusionPipeline.from_pretrained(model_id, torch_dtype=torch.float16)
pipe = pipe.to("cuda")

# 2. Define the Test List (First 10 Species)
cat_species = [
    "Lion", "Tiger", "Jaguar", "Leopard", "Snow Leopard",
    "Cheetah", "Puma", "Clouded Leopard", "Eurasian Lynx", "Bobcat"
]

# 3. Setup One Single Folder
output_folder = "cat_dataset"
os.makedirs(output_folder, exist_ok=True)

images_per_species = 10

print(f"Starting test generation for {len(cat_species)} species.")
print(f"All images will be saved in '{output_folder}/' with the species name in the filename.\n")

# 4. Main Loop
for species in cat_species:
    print(f"Processing: {species}...")

    # Clean the species name for the filename (remove spaces)
    clean_name = species.replace(" ", "")

    for i in range(images_per_species):
        # Prompt
        prompt = f"A realistic, high-quality photograph of a {species} in the wild, 8k resolution, national geographic style"

        # Generate
        image = pipe(prompt).images[0]

        # Save as SpeciesName_Number.png inside the main folder
        filename = f"{clean_name}_{i+1}.png"
        save_path = os.path.join(output_folder, filename)

        image.save(save_path)

print(f"\nSuccess! Generated 100 images in the folder '{output_folder}'.")

import shutil

print("Zipping the dataset... this may take a moment.")
shutil.make_archive('cat_dataset_full', 'zip', 'cat_dataset')

print("Success! Download 'cat_dataset_full.zip' from the file menu on the left.")

import torch
from diffusers import StableDiffusionPipeline
import os

# 1. Setup Model (If not already loaded in previous cell)
# If 'pipe' is already running in memory, you can comment these 3 lines out.
model_id = "runwayml/stable-diffusion-v1-5"
pipe = StableDiffusionPipeline.from_pretrained(model_id, torch_dtype=torch.float16)
pipe = pipe.to("cuda")

# 2. Define the REMAINING 30 Species
# (We excluded the first 10: Lion, Tiger, Jaguar, Leopard, Snow Leopard,
# Cheetah, Puma, Clouded Leopard, Eurasian Lynx, Bobcat)
remaining_species = [
    "Jaguarundi", "Sunda Clouded Leopard",
    "Canada Lynx", "Iberian Lynx",
    "Serval", "Caracal", "African Golden Cat",
    "Asian Golden Cat", "Borneo Bay Cat", "Marbled Cat",
    "Ocelot", "Margay", "Andean Mountain Cat", "Pampas Cat",
    "Geoffroy's Cat", "Kodkod", "Oncilla",
    "Pallas's Cat", "Fishing Cat", "Flat-headed Cat",
    "Rusty-spotted Cat", "Mainland Leopard Cat", "Sunda Leopard Cat",
    "Jungle Cat", "Black-footed Cat", "Sand Cat",
    "Chinese Mountain Cat", "European Wildcat", "African Wildcat", "Domestic Cat"
]

# 3. Use the EXISTING folder
output_folder = "cat_dataset"
os.makedirs(output_folder, exist_ok=True)

images_per_species = 10

print(f"Starting generation for the remaining {len(remaining_species)} species.")
print("This creates 300 images. It will take approximately 20-25 minutes.\n")

# 4. Main Loop
for species in remaining_species:
    print(f"Processing: {species}...")

    # Clean name for filename
    clean_name = species.replace(" ", "")
    clean_name = clean_name.replace("'", "") # Remove apostrophes (like Pallas's)

    for i in range(images_per_species):
        prompt = f"A realistic, high-quality photograph of a {species} in the wild, 8k resolution, national geographic style"

        # Generate
        image = pipe(prompt).images[0]

        # Save
        filename = f"{clean_name}_{i+1}.png"
        save_path = os.path.join(output_folder, filename)
        image.save(save_path)

print(f"\nAll done! You now have the full dataset in '{output_folder}'.")

